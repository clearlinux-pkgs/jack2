From 994e225bbb07a89f56147f7ce7d59beb49f8cfba Mon Sep 17 00:00:00 2001
From: "Joseph A. Yasi" <joe.yasi@gmail.com>
Date: Wed, 19 Jun 2019 00:35:35 -0400
Subject: [PATCH] Set fSocket to -1 after close on an error to prevent a double
 close.

Signed-off-by: Joe Yasi <joe.yasi@gmail.com>
---
 posix/JackSocket.cpp | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/posix/JackSocket.cpp b/posix/JackSocket.cpp
index 73f1fc44..be43d011 100644
--- a/posix/JackSocket.cpp
+++ b/posix/JackSocket.cpp
@@ -137,6 +137,7 @@ int JackClientSocket::Connect(const char* dir, const char* name, int which) // A
     if (connect(fSocket, (struct sockaddr*)&addr, sizeof(addr)) < 0) {
         jack_error("Cannot connect to server socket err = %s", strerror(errno));
         close(fSocket);
+        fSocket = -1;
         return -1;
     }
 
@@ -297,6 +298,7 @@ int JackServerSocket::Bind(const char* dir, const char* name, int which) // A re
 error:
     unlink(fName);
     close(fSocket);
+    fSocket = -1;
     return -1;
 }
 
